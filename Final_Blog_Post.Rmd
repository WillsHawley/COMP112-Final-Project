---
title: "Final Blog Post"
author: "Alex McCreight, Lucy Grochulska, Jacob Kresnicka, Wills Hawley"
output: html_document
runtime: shiny
---

```{r setup,message=FALSE,include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
library(tidyverse)
library(dplyr)
library(ggplot2)
library(shiny)
library(ggthemes)
```
```{r,message=FALSE}
Spotify_Top_2017 <- read_csv("Spotify/Spotify Top 2017.csv")
Spotify_Top_2018 <- read_csv("Spotify/Spotify Top 2018.csv")
Spotify_Big <- read_csv("SpotifyFeatures.csv")

Spotify_Master<-Spotify_Top_2017 %>% 
  bind_rows(Spotify_Top_2018)
```


# Spotify Data

### What effects the popularity of music?


### Overview 

* We examined the "Spotify Track DB" dataset published by Zaheen Hamidani on Kaggle.

* This dataset included a total of 232,725 tracks, sampled from the  26 genres on Spotify.

### Variables 

* 

```{r,layout="1-body-outset"}
library(knitr)
library(rmarkdown)
Mean_Variables<-Spotify_Big %>% 
  summarize("Average Popularity"=mean(popularity),
            "Average Acousticness"=mean(acousticness),
            "Average Danceability"=mean(danceability),
            "Average Duration"=mean(duration_ms),
            "Average Energy"=mean(energy),
            "Average Instrumentalness"=mean(instrumentalness),
            "Average Liveness"=mean(liveness),
            "Average Loudness"=mean(loudness),
            "Average Speechiness"=mean(speechiness),
            "Average Tempo"=mean(tempo),
            "Average Valence"=mean(valence))
kable(Mean_Variables)
```


* The above table provides a mean value for the numerical variables we are examining. This excludes variables such as mode, which is a categorical variable. 

```{r,fig.height=8,fig.width=12}
Spotify_Big %>% 
  ggplot() +
  geom_boxplot(aes(x=fct_reorder(genre,.x=popularity,.fun=median),
                   y=popularity,fill=genre)) +
  coord_flip() +
  labs(x="Genre",y="Popularity") +
  theme_minimal()
```



```{r, echo=FALSE,message=FALSE}
library(shiny)
library(tidyverse)
library(ggthemes)
library(ggplot2)
Spotify_Big <- read_csv("SpotifyFeatures.csv") 
shinyApp(
ui <- fluidPage(
  navbarPage("Spotify Data Analysis App",
             tabPanel("Plot 1",
  titlePanel("Geometric Hexagon Plot"),
    sidebarLayout(
      sidebarPanel(
        selectInput(inputId = "genre", label = "Genre of Music",
                              choices = list("A Capella", "Alternative", "Anime", "Blues", "Children's Music", "Classical", "Comedy",
                                             "Country", "Dance", "Electronic", "Folk", "Hip-Hop", "Indie", "Jazz", "Movie", "Opera",
                                             "Pop", "R&B", "Rap", "Reggae", "Reggaeton", "Rock", "Ska", "Soul", "Soundtrack", "World")),
                  selectInput(inputId = "xaxis", label = "Measure of Music",
                              choices = list(Danceability = "danceability", Acousticness = "acousticness",
                                             `Duration in Milliseconds` = "duration_ms",
                                             Energy = "energy", Intrumentalness = "instrumentalness",
                                             Liveness = "liveness",
                                             Loudness = "loudness", Speechiness = "speechiness",
                                             Tempo = "tempo", Valence = "valence")),
                  submitButton(text="Apply Changes")),
    mainPanel(plotOutput(outputId = "spotplot")))),
    tabPanel("Plot 2",
             titlePanel("Boxplot Distribution"),
             sidebarLayout(
               sidebarPanel(
                 checkboxGroupInput(inputId = "genre1", label = "Genre of Music",
                                                    choices = list("A Capella", "Alternative", "Anime", "Blues", "Children's Music", "Classical", "Comedy",
                                                                   "Country", "Dance", "Electronic", "Folk", "Hip-Hop", "Indie", "Jazz", "Movie", "Opera",
                                                                   "Pop", "R&B", "Rap", "Reggae", "Reggaeton", "Rock", "Ska", "Soul", "Soundtrack", "World")),
                                        selectInput(inputId = "xaxis1", label = "Measure of Music",
                                                    choices = list(Danceability = "danceability", Acousticness = "acousticness",
                                                                   `Duration in Milliseconds` = "duration_ms",
                                                                   Energy = "energy", Intrumentalness = "instrumentalness",
                                                                   Liveness = "liveness",
                                                                   Loudness = "loudness", Speechiness = "speechiness",
                                                                   Tempo = "tempo", Valence = "valence")),
                                        submitButton(text="Apply Changes")),
                           mainPanel(plotOutput(outputId = "boxplot")))
                                        )
    )
  ),


server <- function(input, output){
  output$spotplot <- renderPlot({
    Spotify_Big %>%
      filter(genre == input$genre) %>%
      ggplot(aes(y=popularity)) +
      geom_hex(aes_string(x=input$xaxis)) +
      labs(y="Popularity", fill = "Distribution of Popularity") +
      theme_clean() +
      scale_fill_viridis_c()
    }, height = 700, width = 800)
  
  output$boxplot <- renderPlot({
    Spotify_Big %>%
      filter(genre %in% input$genre1) %>%
      ggplot(aes(x=genre, fill = genre)) +
      geom_boxplot(aes_string(
                       y=input$xaxis1
                       )) +
      labs(x="Genre", fill = "Genre Color") +
      coord_flip() +
      guides(fill = "none")
  }, height = 700, width = 800)
}, options = list(height = 1100, width = 1400)
)



```

